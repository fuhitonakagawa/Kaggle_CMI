ä»¥ä¸‹ã¯ã€**CMI - Detect Behavior with Sensor Data** ã«ãŠã‘ã‚‹ \*\*ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ï¼ç‰¹å¾´é‡ä½œæˆã®è©³ç´°è¨ˆç”»ï¼ˆå®Ÿè£…å‰ä»•æ§˜ï¼‰\*\*ã§ã™ã€‚
ç›®çš„ã¯ã€Œ**BFRBï¼ˆ8 ã‚¯ãƒ©ã‚¹ï¼‰å†…ã®è­˜åˆ¥åŠ›**ã‚’ä¸Šã’ã‚‹ãŸã‚ã®â€œå …ç‰¢ã§å†ç¾æ€§ã®ã‚ã‚‹â€ç‰¹å¾´é‡ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€ã‚’ä½œã‚Šè¾¼ã¿ã€CV ã§ã® **Macro F1ï¼ˆBFRB å†…ï¼‰** ã‚’æŠ¼ã—ä¸Šã’ã‚‹ã“ã¨ã§ã™ã€‚å…¬é–‹ãƒãƒ¼ãƒˆï¼è­°è«–ã®æ–¹é‡ï¼ˆä¾‹ï¼š**World åº§æ¨™åŒ–ãƒ»ç·šå½¢åŠ é€Ÿåº¦åŒ–ãƒ»å‘¨æ³¢æ•°ç‰¹å¾´ãƒ»TOF ç©ºé–“æ§‹é€ ã®æ´»ç”¨**ï¼‰ã‚’å–ã‚Šå…¥ã‚Œã¦ã„ã¾ã™ã€‚([Kaggle][1])

---

## 1) ãƒ‡ãƒ¼ã‚¿æ¦‚è¦³ã¨å‰æ

- **ã‚»ãƒ³ã‚µæ§‹æˆã¨ã‚¿ã‚¹ã‚¯**
  Helios ãƒªã‚¹ãƒˆãƒãƒ³ãƒ‰ã‹ã‚‰ã® **IMUï¼ˆåŠ é€Ÿåº¦ï¼‹å››å…ƒæ•°ï¼‰**, **ToFï¼ˆ5 åŸºã® 8Ã—8 è·é›¢ã‚°ãƒªãƒƒãƒ‰ï¼‰**, **Thermalï¼ˆ5chï¼‰** ã‚’ç”¨ã„ã€**BFRB 8**ï¼‹**é BFRB 10**ã®è¨ˆ 18 ã‚¯ãƒ©ã‚¹ã‚’è­˜åˆ¥ã€‚å­¦ç¿’ã¯ä¸»ã« `behavior == "Performs gesture"` ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å¯¾è±¡ã€‚ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã¯ 20â€¯Hzã€‚([Kaggle][1])
- **ãƒãƒ¼ãƒ‰å‰æï¼ˆToF ã® 8Ã—8ï¼‰**
  ä¸€èˆ¬çš„ãª 8Ã—8 ãƒãƒ«ãƒã‚¾ãƒ¼ãƒ³ ToFï¼ˆä¾‹ï¼šST VL53L5CX ç³»ï¼‰æƒ³å®šã®ç©ºé–“è§£åƒåº¦ãƒ»60â€¯Hz ã¾ã§ã®æ›´æ–°èƒ½åŠ›ã«è¿‘ã„ç‰¹æ€§ã€‚**å„ãƒ•ãƒ¬ãƒ¼ãƒ ï¼è·é›¢ç”»åƒ(8Ã—8)Ã—5 é¢**ã®ç©ºé–“ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒã¤ã€‚([STMicroelectronics][2])
- **å®Ÿå‹™çš„ç¤ºå”†ï¼ˆå…¬é–‹ãƒãƒ¼ãƒˆã‚ˆã‚Šï¼‰**
  IMU ã§ã¯ **World Accï¼ˆä¸–ç•Œåº§æ¨™åŠ é€Ÿåº¦ï¼‰** ã‚„ **ç·šå½¢åŠ é€Ÿåº¦ï¼ˆé‡åŠ›é™¤å»ï¼‰** ãŒåº•ä¸Šã’ã«æœ‰åŠ¹ã€å‘¨æ³¢æ•°ç‰¹å¾´ã®è¿½åŠ ã‚‚å¸¸å¥—ã€‚([Kaggle][3])
- **åˆ©ãæ‰‹ã®å½±éŸ¿**
  ã‚»ãƒ³ã‚µé…ç½®ãŒæ‰‹é¦–å‘¨ã‚Šã§å·¦å³å¯¾ç§°ã§ã¯ãªã„ãŸã‚ã€**handedness** ã«ã‚ˆã£ã¦ TOF/IMU ã®è¦‹ãˆæ–¹ãŒå¤‰ã‚ã‚Šã†ã‚‹ï¼ˆå·¦å³ã§æœ€åˆã«è¦–ç•Œã«å…¥ã‚‹ã‚»ãƒ³ã‚µãƒ¼ãŒç•°ãªã‚‹ç­‰ï¼‰ã€‚([Kaggle][4])

---

## 2) å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆé †åºå³å®ˆï¼‰

### 2.1 ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¨ãƒ•ã‚£ãƒ«ã‚¿

1. `train.csv` ã‚’èª­ã¿è¾¼ã¿ â†’ `behavior == "Performs gesture"` ã®ã¿æŠ½å‡ºã€‚
2. åˆ—ã®åŸºæœ¬æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼š

   - IMU: `acc_{x,y,z}`, `rot_{w,x,y,z}`
   - ToF: `tof_{1..5}_v{0..63}`ï¼ˆ-1 ã¯æ¬ æ¸¬æ‰±ã„ï¼‰
   - Thermal: `thm_{1..5}`
   - ãƒ¡ã‚¿: `sequence_id`, `subject`, `gesture`, `handedness`, ã»ã‹ã€‚([Kaggle][1])

### 2.2 æ™‚é–“è»¸ã®æ•´å‚™ï¼ˆ20â€¯Hz åŸºæº–ï¼‰

1. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å†…ã®é‡è¤‡ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—é™¤å»ãƒ»æ•´åˆ—ã€‚
2. ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é–“éš”ã®ä¹±ã‚Œã‚’**ç·šå½¢è£œé–“**ã§è£œæ­£ï¼ˆç«¯ç‚¹ã¯æœ€è¿‘å‚å€¤ä¿æŒï¼‰ã€‚
3. ToF/Thermal/IMU ã®**è¡ŒåŒæœŸ**ï¼ˆè¡Œæ•°å·®ãŒå‡ºãŸå ´åˆã¯çŸ­ã„ç³»åˆ—ã«åˆã‚ã›ã¦åˆ‡ã‚Šè½ã¨ã— or è£œé–“ï¼‰ã€‚

   - **æ³¨æ„**ï¼šè£œé–“ã¯\*\*å›è»¢ï¼ˆå››å…ƒæ•°ï¼‰\*\*ã«ç›´æ¥é©ç”¨ã—ãªã„ï¼ˆâ†’ 2.3 ã§å‡¦ç†ï¼‰ã€‚

### 2.3 IMUï¼šå››å…ƒæ•°ã®å¥å…¨åŒ–ã¨é‡åŠ›é™¤å»ãƒ»åº§æ¨™å¤‰æ›

1. **å››å…ƒæ•°ã® NaN è£œå®Œ â†’ æ­£è¦åŒ–**ï¼š`ffillâ†’bfillâ†’(1,0,0,0) ã§è£œå®Œ` â†’ L2 æ­£è¦åŒ–ã€‚
2. **ä¸–ç•Œåº§æ¨™åŒ–**ï¼šå››å…ƒæ•° $q_t$ ã‚’ç”¨ã„ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«åŠ é€Ÿåº¦ $a_t$ ã‚’**ãƒ¯ãƒ¼ãƒ«ãƒ‰ç³»**ã«å›è»¢ã€‚
3. **é‡åŠ›é™¤å»ï¼ˆç·šå½¢åŠ é€Ÿåº¦ï¼‰**ï¼š

   - æ–¹æ³• Aï¼šãƒ¯ãƒ¼ãƒ«ãƒ‰ç³»ã§ $g=[0,0,9.81]$ ã‚’é€†å›ã—ã—ã¦ã‚»ãƒ³ã‚µåº§æ¨™ã¸æŠ•å½± â†’ å·®ã—å¼•ãã€‚
   - æ–¹æ³• Bï¼šãƒ­ãƒ¼ãƒ‘ã‚¹ï¼ˆä¾‹ï¼š2â€“3â€¯Hzï¼‰ã§é‡åŠ›æˆåˆ†ã‚’æ¨å®šã—ã€é«˜åŸŸå´ã‚’**ç·šå½¢åŠ é€Ÿåº¦**ã¨ã¿ãªã™ã€‚

4. **è§’é€Ÿåº¦ã®è¿‘ä¼¼**ï¼šå››å…ƒæ•°å·®åˆ†ã‹ã‚‰ã®å›è»¢ãƒ™ã‚¯ãƒˆãƒ« $\omega_t \approx \log(q_{t}^{-1} q_{t+1}) / \Delta t$ã€‚
   â€» WorldAccï¼Linear Acc ã‚’ä½¿ã†æ‰‹æ³•ã¯ IMU ãƒ™ãƒ¼ã‚¹ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã§é »ç”¨ã€‚([Kaggle][3])

### 2.4 ToFï¼šæ¬ æ¸¬ãƒ»å¤–ã‚Œå€¤ãƒ»ç©ºé–“åœ§ç¸®

1. **æ¬ æ¸¬å‡¦ç†**ï¼š`-1` â†’ `NaN`ã€‚å„ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã¤ã

   - æœ‰åŠ¹ç”»ç´ ç‡ï¼ˆvalid_ratioï¼‰ã€æœ€å°ãƒ»æœ€å¤§ãƒ»ä¸­å¤®å€¤ã€åˆ†ä½ï¼ˆp10/p50/p90ï¼‰ã€**æœ€å°è·é›¢ï¼ˆmin_distï¼‰**ã€‚

2. **å¤–ã‚Œå€¤å‡¦ç†**ï¼šå„ãƒ•ãƒ¬ãƒ¼ãƒ ã®æœ‰åŠ¹ç”»ç´ ã‚’**åˆ†ä½ã‚¯ãƒªãƒƒãƒ—ï¼ˆp1â€“p99ï¼‰**ã€‚
3. **ç©ºé–“åœ§ç¸®ï¼ˆå­¦ç¿’æ™‚ã« fitâ†’ æ¨è«–æ™‚ transformï¼‰**ï¼š

   - **PCAï¼ˆå„ ToF 64â†’8 æˆåˆ†ï¼‰**ï¼šå…¨ãƒ•ãƒ¬ãƒ¼ãƒ ã®(8Ã—8)ã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ– â†’ æ¨™æº–åŒ– â†’PCAã€‚
   - ä»£æ›¿ï¼š**2D ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆé‡å¿ƒãƒ»2 æ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãƒ»åå¿ƒç‡ï¼‰**ã‚„**Laplacian/å‹¾é…å’Œ**ã€‚

4. **å·¦å³å·®å¯¾ç­–**ï¼š`handedness` ã§**ã‚»ãƒ³ã‚µãƒ¼ç•ªå·ã®å·¦å³åè»¢**ã‚’è©¦ã™ï¼ˆãƒãƒƒãƒ”ãƒ³ã‚°ç­–å®šãŒé›£ã—ã„å ´åˆã¯ã€ã€Œå„ãƒ•ãƒ¬ãƒ¼ãƒ ã§**ã‚»ãƒ³ã‚µãƒ¼é–“ min/mean**ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ç‰¹å¾´ï¼‹å„ã‚»ãƒ³ã‚µãƒ¼å€‹åˆ¥ç‰¹å¾´ã€ã‚’ä¸¡æ–¹æŒã¤ï¼‰ã€‚

   - åˆ©ãæ‰‹ã§è¦‹ãˆæ–¹ãŒå¤‰ã‚ã‚‹ç‚¹ã¯å…¬é–‹ EDA ã§ã‚‚æŒ‡æ‘˜ã‚ã‚Šã€‚([Kaggle][4])

### 2.5 Thermalï¼šå¹³æ»‘åŒ–ã¨å·®åˆ†

1. **å¹³æ»‘åŒ–**ï¼šç§»å‹•å¹³å‡ï¼ˆä¾‹ï¼š5ã€œ9 ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã€‚
2. **ä¸€æ¬¡ï¼äºŒæ¬¡å·®åˆ†**ï¼šä¸Šæ˜‡ãƒ»ä¸‹é™ã®ã‚¹ãƒ­ãƒ¼ãƒ—ã‚’æŠ½å‡ºã€‚
3. **æ¸©åº¦å‹¾é…ã®æŒ‡æ¨™**ï¼šmaxâ€“minã€åˆ†ä½å¹…ï¼ˆp90â€“p10ï¼‰ã€**æ¸©åº¦ã‚¤ãƒ™ãƒ³ãƒˆç‡**ï¼ˆ|å·®åˆ†|>é–¾å€¤ï¼‰ã€‚

### 2.6 æ­£è¦åŒ–ã®ç²’åº¦ï¼ˆãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰

- **Sequence å†… Z-score**ï¼ˆå„ãƒãƒ£ãƒ³ãƒãƒ«ï¼‰â†’ **Fold å†… Train ã§ fit ã—ãŸ RobustScaler/StandardScaler** ã‚’é †æ¬¡é©ç”¨ã€‚

  - ç›®çš„ï¼šè¢«é¨“è€…é–“å·®ã‚’å¹³æº–åŒ–ã—ã¤ã¤ã€CV ãƒªãƒ¼ã‚¯ã‚’é˜²æ­¢ã€‚

- **PCAãƒ»åˆ†ä½åŸºæº–å€¤**ã‚‚**fold å†… train ã§ fit**ã—ã€æ¨è«–ã¯ transform ã®ã¿ã€‚

---

## 3) ç‰¹å¾´é‡ãƒ•ã‚¡ãƒŸãƒªï¼ˆä½œæˆä»•æ§˜ï¼‰

> ã“ã“ã‹ã‚‰ã¯ã€Œ**ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å…¨ä½“**ã€ã«å¯¾ã—ã¦é›†ç´„ã—ã¦ä½œã‚‹**sequence-level ç‰¹å¾´**ã‚’ä¸­å¿ƒã«å®šç¾©ã—ã¾ã™ï¼ˆKaggle è©•ä¾¡ã‚µãƒ¼ãƒã¯ 1 ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ â†’1 äºˆæ¸¬ã‚’æƒ³å®šï¼‰ã€‚IMU ã® **WorldAccï¼Linear Acc**ã€å‘¨æ³¢æ•°ç‰¹æ€§ã€ToF ã®**ç©ºé–“ Ã— æ™‚é–“**ã€Thermal ã®**é…ã„å‚¾ã**ã‚’å–ã‚Šã“ã¼ã•ãªã„ã®ãŒè‚ã§ã™ã€‚([Kaggle][1])

### 3.1 IMUï¼ˆåŠ é€Ÿåº¦ãƒ»ç·šå½¢åŠ é€Ÿåº¦ãƒ»è§’é€Ÿåº¦ï¼‰

**å…¥åŠ›ç³»åˆ—**ï¼š

- `acc_world_{x,y,z}`, `acc_world_mag`
- `linacc_{x,y,z}`, `linacc_mag`
- è§’é€Ÿåº¦ `omega_{x,y,z}`, `omega_mag`ï¼ˆå››å…ƒæ•°å·®åˆ†ã‹ã‚‰ï¼‰
- ã‚ªãƒªã‚¨ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ `roll/pitch/yaw`ï¼ˆå››å…ƒæ•° â†’ ã‚ªã‚¤ãƒ©ãƒ¼ï¼‰

**æ™‚é–“é ˜åŸŸï¼ˆå„ç³»åˆ—ï¼‰**

- åŸºæœ¬çµ±è¨ˆï¼šmean/std/min/max/median/p10/p90/IQR/range/CV
- å½¢çŠ¶ï¼šskew/kurtosisã€**line length**ï¼ˆ|å·®åˆ†|å’Œï¼‰ã€**Hjorth**ï¼ˆactivity, mobility, complexityï¼‰
- å¤‰åŒ–ç‡ï¼šä¸€éšå·®åˆ†ï¼ˆjerk/è§’é€Ÿåº¦å·®åˆ†ï¼‰ã® mean/std/max/åˆ†ä½
- åŒºé–“çµ±è¨ˆï¼š\*\*3 åˆ†å‰²ï¼ˆearly/mid/lateï¼‰\*\*ã® mean/std/maxã€å¤‰åŒ–é‡ï¼ˆlastâ€“firstï¼‰
- ãƒ”ãƒ¼ã‚¯ï¼š`find_peaks` ã«ã‚ˆã‚‹ãƒ”ãƒ¼ã‚¯æ•°ã€å¹³å‡é–“éš”ã€æœ€å¤§æŒ¯å¹…

**å‘¨æ³¢æ•°é ˜åŸŸï¼ˆå„ç³»åˆ—ï¼‰**

- **Welch PSD** â†’ ãƒãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼ï¼š**0.3â€“3â€¯Hz**, **3â€“8â€¯Hz**, **8â€“12â€¯Hz**
- ã‚¹ãƒšã‚¯ãƒˆãƒ«é‡å¿ƒãƒ»**roll-off(85%)**ãƒ»**ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼**ãƒ»æœ€å¤§ãƒ”ãƒ¼ã‚¯å‘¨æ³¢æ•°ï¼†ãƒ‘ãƒ¯ãƒ¼
- **ZCR**ï¼ˆç¬¦å·åè»¢ç‡ã€æ­£è¦åŒ–ï¼‰

> WorldAccï¼Linear Acc ã®æ´»ç”¨ãƒ»å‘¨æ³¢æ•°ç‰¹å¾´ã®æœ‰åŠ¹æ€§ã¯å…¬é–‹ãƒãƒ¼ãƒˆã§ç¹°ã‚Šè¿”ã—è¨€åŠã€‚([Kaggle][3])

**ç›¸é–¢ï¼çµåˆ**

- è»¸é–“ç›¸é–¢ï¼ˆxâ€“y, yâ€“z, zâ€“x; world & linearï¼‰
- `linacc_mag` ã¨ `omega_mag` ã®ç›¸é–¢ï¼ˆã€Œé€Ÿã„å‹•ãï¼‹ã²ã­ã‚Šã€ï¼‰
- roll/pitch/yaw ã®ãƒ¬ãƒ³ã‚¸ã€æ¨™æº–åå·®ã€æ–¹å‘è»¢æ›å›æ•°

### 3.2 ToFï¼ˆ5 åŸº Ã—8Ã—8ï¼‰ â€»å„ã‚»ãƒ³ã‚µãƒ¼ã”ã¨ï¼‹ã‚»ãƒ³ã‚µãƒ¼æ¨ªæ–­

**ãƒ•ãƒ¬ãƒ¼ãƒ å†…ï¼ˆç©ºé–“ï¼‰**

- çµ±è¨ˆï¼švalid_ratio, mean/std/min/max, p10/p50/p90, **min_dist**
- å½¢çŠ¶ï¼š**é‡å¿ƒ (cx, cy)**ã€äºŒæ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆxx, yy, xyï¼‰ã€**åå¿ƒç‡**ã€ä¸»æˆåˆ†è§’åº¦
- ãƒ†ã‚¯ã‚¹ãƒãƒ£ï¼šSobel/Laplacian å‹¾é…å’Œã€**ã‚¨ãƒƒã‚¸ç‡**ã€**å±€æ‰€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ**
- ã‚¯ãƒ©ã‚¹ã‚¿ï¼šé–¾å€¤ï¼ˆè¿‘è·é›¢ï¼‰ã§ 2 å€¤åŒ– â†’ æœ€å¤§é€£çµæˆåˆ†ã® **é¢ç©/å‘¨å›²é•·/å††å½¢åº¦**
- PCA ä¿‚æ•°ï¼ˆ64â†’8ï¼‰ã¨å†æ§‹æˆèª¤å·®ï¼ˆç©ºé–“åœ§ç¸®å¾Œã®æ®‹å·®ï¼‰

**æ™‚é–“æ–¹å‘ï¼ˆæ™‚ç³»åˆ—ï¼‰**

- `min_dist`ï¼`mean` ã®é€Ÿåº¦ï¼ˆä¸€æ¬¡å·®åˆ†ï¼‰ãƒ»åŠ é€Ÿåº¦ï¼ˆäºŒæ¬¡å·®åˆ†ï¼‰
- ä½å‘¨æ³¢å¤‰å‹•ï¼šç§»å‹•å¹³å‡ã®å¤‰åŒ–é‡ã€**åŒºé–“çµ±è¨ˆï¼ˆ3 åˆ†å‰²ï¼‰**
- **åˆ°é”ã‚¤ãƒ™ãƒ³ãƒˆç‡**ï¼šè¿‘è·é›¢é–¾å€¤ã‚’ä¸‹å›ã‚‹å‰²åˆã€ä¸‹å›ã‚Šã®é€£ç¶šé•·ï¼ˆè§¦ã‚Œã«ã„ãå‹•ãï¼‰
- **ã‚»ãƒ³ã‚µãƒ¼è·¨ãã®åŒæœŸ**ï¼š5 åŸº `min_dist` ã®åŒæ™‚ä½ä¸‹ç‡ãƒ»æ™‚å·®ï¼ˆface/neck ã¸ã®æ¥è¿‘ã®æ‰‹æ›ã‹ã‚Šï¼‰

**ã‚»ãƒ³ã‚µãƒ¼æ¨ªæ–­**

- ãã®æ™‚ç‚¹ã§ã® **min across sensors**ï¼ˆã€Œã©ã‚Œã‹ãŒè¿‘ã„ã€ï¼‰ã®æ™‚ç³»åˆ— â†’ çµ±è¨ˆï¼é »åº¦
- **handedness** ã§ã‚»ãƒ³ã‚µãƒ¼ç•ªå·ã‚’å·¦å³åè»¢ã—ãŸæ´¾ç”Ÿç³»åˆ—ï¼ˆA/B ä¸¡æ–¹ä½œã‚‹ï¼‰

> ToF ã¯**8Ã—8 ã®â€œè·é›¢ç”»åƒâ€**ã§ã‚ã‚Šã€å˜ãªã‚‹ mean/std ã®ã¿ã§ã¯ç©ºé–“ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå¤±ã‚ã‚Œã‚‹ãŸã‚ã€**é‡å¿ƒãƒ»ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãƒ»PCA**ãªã©**ç©ºé–“å½¢çŠ¶**ã‚’æ®‹ã™ã€‚8Ã—8 ã®å‰æã¯ä¸€èˆ¬çš„ãƒãƒ«ãƒã‚¾ãƒ¼ãƒ³ ToF è³‡æ–™ã«ã‚‚æ²¿ã†ã€‚([STMicroelectronics][2])

### 3.3 Thermalï¼ˆ5chï¼‰

- çµ±è¨ˆï¼šmean/std/min/max/p10/p90/IQR
- å‚¾ãï¼šä¸€æ¬¡ï¼äºŒæ¬¡å·®åˆ†ã® mean/std/maxã€**ãƒˆãƒ¬ãƒ³ãƒ‰ç›¸é–¢ï¼ˆæ™‚åˆ» vs å€¤ï¼‰**
- å¤‰åŒ–ã‚¤ãƒ™ãƒ³ãƒˆç‡ï¼š|ä¸€éšå·®åˆ†|>é–¾å€¤ ã®å‰²åˆ
- ToF ã¨ã®çµåˆï¼š`min_dist` ä½ä¸‹æ™‚ã® Thermal ã®å¤‰åŒ–é‡ï¼ˆæ¥è¿‘ â†’ æ¸©åº¦ä¸Šæ˜‡ã®é€£å‹•ï¼‰

### 3.4 ã‚¯ãƒ­ã‚¹ãƒ¢ãƒ¼ãƒ€ãƒ«ç‰¹å¾´ï¼ˆIMUÃ—ToFÃ—Thermalï¼‰

- **ãƒŸã‚¯ãƒ­åŒæœŸ**ï¼š`linacc_mag` ã®ãƒ”ãƒ¼ã‚¯è¿‘å‚ï¼ˆÂ±0.5â€¯sï¼‰ã§ `min_dist` ãŒã©ã‚Œãã‚‰ã„ä¸‹ãŒã‚‹ã‹ï¼ˆå¹³å‡/æœ€å°ï¼‰
- **æ•´åˆåº¦**ï¼šIMU ã®é€²è¡Œæ–¹å‘ï¼ˆworld åº§æ¨™ã®ç¬¦å·ï¼‰ã¨ã€ã©ã® ToF é¢ã® `min_dist` ãŒå…ˆã«ä¸‹ãŒã‚‹ã‹ã®ä¸€è‡´ç‡
- **ãƒˆãƒªãƒ—ãƒ¬ãƒƒãƒˆ**ï¼š(`min_dist` ä½ä¸‹ â†’ Thermal ä¸Šæ˜‡ â†’ `linacc` ãƒ”ãƒ¼ã‚¯) ã®é †åºä¸€è‡´åº¦

---

## 4) æ­£è¦åŒ–ãƒ»å®‰å®šåŒ–ãƒ»å“è³ªæŒ‡æ¨™

- **äºŒæ®µæ­£è¦åŒ–**ï¼š

  1. **Sequence å†… Z-score**ï¼ˆæ¬ æ¸¬é™¤å¤–ï¼‰
  2. **Fold å†… Train ã§ fit ã—ãŸ Scaler**ï¼ˆRobust/Standardï¼‰

- **å¤–ã‚Œå€¤ã‚¯ãƒªãƒƒãƒ—**ï¼šå„ç³»åˆ—ã§ **p1â€“p99** ã¸ã‚¯ãƒªãƒƒãƒ—ï¼ˆå­¦ç¿’ fold å†…ã§é–¾å€¤æ¨å®šï¼‰ã€‚
- **å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹**ï¼š

  - æ¬ æ¸¬ç‡ï¼ˆIMU/ToF/Thermal åˆ¥ï¼‰
  - ToF ã® valid_ratio ã®å¹³å‡ã¨åˆ†æ•£ã€valid é€£ç¶š 0 åŒºé–“ã®æœ€å¤§é•·
  - ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é•·ã€**æœ‰åŠ¹é•·/ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°æ¯”**
  - ã“ã‚Œã‚‰ã‚’**èª¬æ˜å¤‰æ•°ã¨ã—ã¦ã‚‚ä¿æŒ**ï¼ˆâ€œæ‚ªã„ãƒ‡ãƒ¼ã‚¿â€ã®å½±éŸ¿ã‚’ç·©å’Œï¼‰

---

## 5) æ™‚ç³»åˆ—ã®åˆ‡ã‚Šæ–¹ã¨é›†ç´„æˆ¦ç•¥

- **ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°é•·**ï¼šé•·ã•åˆ†å¸ƒã® **95â€“98 ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«** ã‚’ CV ã”ã¨ã«æ¡ç”¨ï¼ˆç„¡ç†ã«åˆ‡ã‚Šæ¨ã¦ãªã„ï¼‰ã€‚
- **ã‚»ã‚°ãƒ¡ãƒ³ãƒˆé›†ç´„**ï¼š**early/mid/lateï¼ˆ3 åˆ†å‰²ï¼‰**ã®çµ±è¨ˆã‚’**å…¨ä½“çµ±è¨ˆã¨ä½µç½®**ï¼ˆâ€œç«‹ã¡ä¸ŠãŒã‚Šï¼é›¢è„±â€ã‚’æ‰ãˆã‚‹ï¼‰ã€‚
- **å¤šè§£åƒåº¦é›†ç´„**ï¼š0.5â€¯sï¼1â€¯sï¼2â€¯s ã®**çª“å¹³å‡ã‚’ç•³ã¿**ã€ãã®æœ€çµ‚çµ±è¨ˆï¼ˆmean/std/p10/p90ï¼‰ã‚‚è¿½åŠ ï¼ˆâ€œTemporal Pyramidâ€ã®ç°¡æ˜“ç‰ˆï¼‰ã€‚

---

## 6) CVãƒ»ç‰¹å¾´è©•ä¾¡ï¼ˆå®Ÿè£…æ™‚ã®æ¤œè¨¼è¨­è¨ˆï¼‰

- **åˆ†å‰²**ï¼š`StratifiedGroupKFold(n_splits=5, group=subject)`ï¼ˆå±¤ï¼ BFRB/é BFRB ï¼‹ BFRB å†…é »åº¦ï¼‰ã€‚
- **è©•ä¾¡**ï¼šFold ã”ã¨ã«

  - **Binary F1**ï¼ˆBFRB vs é BFRBï¼‰
  - **Macro F1ï¼ˆBFRB 8 å†…ï¼‰**
  - \*_Combined = 0.5_(Binary F1 + Macro F1)\*\*

- **ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°**ï¼š

  - LightGBM/XGBoost ã® **OOF é‡è¦åº¦**ï¼ˆGainï¼‰
  - **Permutation Importance** ã§ãƒªãƒ¼ã‚¯ã‚„å†—é•·ã‚’é™¤å»
  - **ç›¸é–¢ã—éããŸç‰¹å¾´**ã®æåˆˆã‚Šï¼ˆ|Ï|>0.95ï¼‰

- **ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é †**ï¼š

  1. IMU: Raw â†’ WorldAcc â†’ LinearAcc â†’ å‘¨æ³¢æ•°è¿½åŠ 
  2. ToF: mean/std ã®ã¿ â†’ +min/valid_ratio â†’ +PCA/é‡å¿ƒ/ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
  3. Thermal: çµ±è¨ˆã®ã¿ â†’ +å‚¾ã/å·®åˆ† â†’ +ToF é€£å‹•
  4. ã‚¯ãƒ­ã‚¹ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆãƒ”ãƒ¼ã‚¯åŒæœŸ ç­‰ï¼‰

> ã“ã“ã¾ã§ã® CVãƒ»è©•ä¾¡æ–¹é‡ã¯ã‚³ãƒ³ãƒšã®è©•ä¾¡å½¢ã«æº–æ‹ ã€‚([Kaggle][1])

---

## 7) æ¨è«–æ™‚ã®å†ç¾æ€§ãƒ»å®Ÿè£…å‹˜æ‰€

- **åŒä¸€å‡¦ç†ã®å³å¯†å†ç¾**ï¼šPCA/Scaler/åˆ†ä½é–¾å€¤ã¯**å­¦ç¿’ fold ã® fit è³‡ç”£**ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦**transform ã®ã¿**ã€‚
- **è¨ˆç®—é‡åˆ¶ç´„**ï¼šKaggle ã®æ¨è«–ç’°å¢ƒã§**1 ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚ãŸã‚Šæ•°å msã€œæ•°ç™¾ ms**ç›®å®‰ã€‚

  - ToF ã®**ç©ºé–“ç•³ã¿è¾¼ã¿ã¯é¿ã‘**ã€**äº‹å‰ fit æ¸ˆã¿ PCA**ï¼‹è»½é‡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã§æ¸ˆã¾ã™ã€‚
  - Welch ã¯\*\*çª“é•·ã‚’å…±é€šï¼ˆä¾‹ï¼š128, overlap 50%ï¼‰\*\*ã«å›ºå®šã€‚

- **ãƒ†ã‚¹ãƒˆã®å¥å…¨æ€§**ï¼š

  - å…¥åŠ› NaN å¤§é‡æ™‚ã®**ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ—¢å®šå€¤ï¼‰**
  - Sequence ãŒæ¥µç«¯ã«çŸ­ã„å ´åˆï¼ˆï¼œ 10 ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã¯**ç°¡æ˜“çµ±è¨ˆã®ã¿**ã§åŸ‹ã‚ã‚‹

---

## 8) å…·ä½“çš„ãªâ€œç‰¹å¾´é‡ãƒªã‚¹ãƒˆâ€ï¼ˆæŠœç²‹ãƒ»æ‹¡å¼µå¯ï¼‰

> **1 ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚ãŸã‚Š**ã§è¨ˆç®—ãƒ»æ ¼ç´ï¼ˆæ•°ç™¾ã€œåƒæ¬¡å…ƒç¨‹åº¦ã‚’æƒ³å®šï¼‰

**IMUï¼ˆå„ç³»åˆ—ï¼šacc_world_x/y/z, acc_world_mag, linacc_x/y/z, linacc_mag, Ï‰_x/y/z, Ï‰_mag, roll/pitch/yawï¼‰**

- åŸºæœ¬çµ±è¨ˆï¼ˆ10 å€‹å‰å¾Œï¼‰Ã— ç³»åˆ—æ•°
- å·®åˆ†ï¼ˆjerk/è§’é€Ÿåº¦å·®åˆ†ï¼‰ã®çµ±è¨ˆï¼ˆ5 å€‹å‰å¾Œï¼‰Ã— ç³»åˆ—æ•°
- Welch ãƒãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼ï¼ˆ3 å¸¯åŸŸï¼‰ï¼‹æœ€å¤§ãƒ”ãƒ¼ã‚¯å‘¨æ³¢æ•°/é›»åŠ›ï¼‹é‡å¿ƒ/ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼/roll-offï¼ˆ6ã€œ8 å€‹ï¼‰Ã— ç³»åˆ—æ•°
- åŒºé–“çµ±è¨ˆï¼ˆ3 åˆ†å‰² Ã—2 å€‹ï¼‰Ã— ç³»åˆ—æ•°
- è»¸é–“ç›¸é–¢ï¼ˆ3 çµ„ï¼‰Ã—ï¼ˆworld/linear ãªã©å¯¾è±¡ç¾¤ï¼‰

**ToFï¼ˆå„ã‚»ãƒ³ã‚µãƒ¼ Ã— ãƒ•ãƒ¬ãƒ¼ãƒ  â†’ é›†ç´„ï¼‰**

- ãƒ•ãƒ¬ãƒ¼ãƒ çµ±è¨ˆï¼ˆvalid_ratio, min/mean/std/åˆ†ä½ã€min_distï¼‰â†’**æ™‚é–“é›†ç´„ï¼ˆmean/std/p10/p90/max/ã‚¤ãƒ™ãƒ³ãƒˆç‡ï¼‰**
- ç©ºé–“ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆé‡å¿ƒãƒ»2 æ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãƒ»åå¿ƒï¼‰â†’**æ™‚é–“é›†ç´„**
- PCA ä¿‚æ•°ï¼ˆ8 æ¬¡å…ƒï¼‰â†’**æ™‚é–“é›†ç´„ï¼ˆmean/std/max/åˆ†ä½ï¼‰**
- è¿‘æ¥ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆé–¾å€¤ä¸‹å›ã‚Šç‡ã€æœ€é•·é€£ç¶šé•·ã€å›æ•°ï¼‰
- 5 ã‚»ãƒ³ã‚µãƒ¼æ¨ªæ–­ï¼šæ™‚ç‚¹ã”ã¨ã® **min across sensors** ã‚·ãƒªãƒ¼ã‚º â†’ åŒæ§˜ã«æ™‚é–“é›†ç´„

**Thermalï¼ˆ5chï¼‰**

- åŸºæœ¬çµ±è¨ˆï¼‹å·®åˆ†çµ±è¨ˆï¼‹ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆç›¸é–¢ä¿‚æ•°ï¼‰
- ToF ã®è¿‘æ¥ã‚¤ãƒ™ãƒ³ãƒˆçª“å†…ã§ã®æ¸©åº¦ä¸Šæ˜‡é‡ï¼ˆå¹³å‡/æœ€å¤§ï¼‰

**ã‚¯ãƒ­ã‚¹ãƒ¢ãƒ¼ãƒ€ãƒ«**

- `linacc_mag` ãƒ”ãƒ¼ã‚¯è¿‘å‚ã® `min_dist` ä½ä¸‹é‡ï¼ˆmean/minï¼‰
- `omega_mag` ãƒ”ãƒ¼ã‚¯æ™‚ã® ToF æœ‰åŠ¹ç”»ç´ ç‡ã®å¤‰åŒ–
- roll/pitch/yaw ã®å¤‰åŒ–æ–¹å‘ã¨ã€ã©ã® ToF é¢ã® `min_dist` ãŒå…ˆè½ã¡ã™ã‚‹ã‹ã®ä¸€è‡´ç‡

---

## 9) å“è³ªç®¡ç†ãƒ»ãƒ­ã‚°

- **ç‰¹ç•°ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®è‡ªå‹•ãƒãƒ¼ã‚­ãƒ³ã‚°**ï¼š

  - æ¬ æ¸¬ç‡>30%ã€ToF å…¨ã‚»ãƒ³ã‚µãƒ¼ valid_ratio<0.2 ãŒé•·ãç¶šã ç­‰

- **åˆ†å¸ƒç›£è¦–**ï¼šå­¦ç¿’ fold é–“ã§ä¸»ç‰¹å¾´ï¼ˆä¾‹ï¼š`linacc_mag` mean, ToF `min_dist` p10ï¼‰ã®åˆ†å¸ƒå·®ã‚’å¯è¦–åŒ–
- **å†ç¾æ€§**ï¼šä¹±æ•° SEED å›ºå®šã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä»˜ã‘ï¼ˆPCA/Scaler ã® `fit_version`ï¼‰

---

## 10) å‚è€ƒï¼ˆå…¬é–‹æƒ…å ±ã®æ–¹å‘æ€§ï¼‰

- **ãƒ‡ãƒ¼ã‚¿ã¨ç›®çš„**ï¼šCMI å…¬å¼ãƒšãƒ¼ã‚¸ï¼ˆHeliosã€BFRB/é BFRBã€ã‚»ãƒ³ã‚µæ§‹æˆã®æ¦‚èª¬ï¼‰ã€‚([Kaggle][1])
- **IMU ç³»ã®å¼·åŒ–**ï¼šWorld Acc / Linear Acc ã‚’ä½¿ã† IMU ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã€BiLSTM+GRU ã®ç·šå½¢åŠ é€Ÿåº¦æ´»ç”¨ã€‚([Kaggle][3])
- **å‘¨æ³¢æ•°ç‰¹å¾´**ï¼šIMU ã«å‘¨æ³¢æ•°ãƒ‰ãƒ¡ã‚¤ãƒ³ç‰¹å¾´ã‚’è¶³ã—ãŸæ¨è«–ãƒãƒ¼ãƒˆã€‚([Kaggle][5])
- **IMU+ToF/THM ã®ä½µç”¨**ï¼š2 ãƒ–ãƒ©ãƒ³ãƒå‹ DL ã§ã®å–ã‚Šçµ„ã¿ï¼ˆæ§‹æˆä¾‹ï¼‰ã€‚([Kaggle][6])
- **ToF ã® 8Ã—8 èƒŒæ™¯**ï¼šä¸€èˆ¬çš„ ToF ã® 8Ã—8 ä»•æ§˜ï¼ˆVL53L5CX ç­‰ï¼‰ã€‚([STMicroelectronics][2])
- **åˆ©ãæ‰‹ã®å½±éŸ¿**ï¼šEDA ã§ã®æŒ‡æ‘˜ï¼ˆã‚»ãƒ³ã‚µãƒ¼é…ç½® Ã—handednessï¼‰ã€‚([Kaggle][4])

---

### å®Ÿè£…æ™‚ã® ToDoï¼ˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼‰

- [ ] **CV åŸºç›¤**ï¼š`StratifiedGroupKFold(subject)` ã®å…±é€šåŒ–ï¼ˆå±¤ã¯ BFRB/é BFRB ï¼‹ BFRB å†…åˆ†å¸ƒï¼‰
- [ ] **å››å…ƒæ•°ç³»**ï¼šNaN è£œå®Œ â†’ æ­£è¦åŒ– â†’World åº§æ¨™ â†’ é‡åŠ›é™¤å»ï¼ˆA/B åˆ‡æ›¿å¯èƒ½ï¼‰
- [ ] **è§’é€Ÿåº¦**ï¼šå››å…ƒæ•°å·®åˆ†ã‹ã‚‰ã® $\omega$ å°å‡ºé–¢æ•°
- [ ] **ToF**ï¼š-1â†’NaNã€åˆ†ä½ã‚¯ãƒªãƒƒãƒ—ã€**PCA(64â†’8)** ã® fit/transform è³‡ç”£åŒ–ã€é‡å¿ƒãƒ»ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
- [ ] **Thermal**ï¼šå¹³æ»‘åŒ–ãƒ»å·®åˆ†ãƒ»å‚¾ã
- [ ] **äºŒæ®µæ­£è¦åŒ–**ï¼šsequence å†… Z-score â†’ fold-scalerï¼ˆfit/transform åˆ†é›¢ï¼‰
- [ ] **ç‰¹å¾´ç”Ÿæˆ**ï¼šIMU æ™‚é–“/å‘¨æ³¢æ•°ã€ToF ç©ºé–“/æ™‚ç³»åˆ—ã€Thermalã€ã‚¯ãƒ­ã‚¹ãƒ¢ãƒ¼ãƒ€ãƒ«
- [ ] **å“è³ªç‰¹å¾´**ï¼švalid ç‡ãƒ»æ¬ æ¸¬ç‡ãƒ»é€£ç¶šæ¬ æ¸¬é•·ãƒ»é•·ã•ãªã©
- [ ] **é€Ÿåº¦æœ€é©åŒ–**ï¼šPolars/NumPy ãƒ™ãƒ¼ã‚¹ã®**ãƒ™ã‚¯ãƒˆãƒ«åŒ–**ã€Welch çª“å›ºå®šã€PCA ãƒãƒƒãƒå¤‰æ›
- [ ] **è¨˜éŒ²**ï¼šfit æ¸ˆã¿è³‡ç”£ï¼ˆScaler/PCA/åˆ†ä½ï¼‰ã‚’ pickle åŒ–ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

---

å¿…è¦ã§ã‚ã‚Œã°ã€ã“ã®è¨ˆç”»ã‚’ãã®ã¾ã¾**é–¢æ•°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ï¼‹å‹**ã¾ã§å±•é–‹ã—ã¾ã™ï¼ˆ`extract_features(sequence_df, demo_df, assets)->feature_row` ã®ã‹ãŸã¡ï¼‰ã€‚ã¾ãšã¯ã“ã®ä»•æ§˜ã§ä¸è¶³ãŒãªã„ã‹ã”ç¢ºèªãã ã•ã„ã€‚

[1]: https://www.kaggle.com/competitions/cmi-detect-behavior-with-sensor-data/data?utm_source=chatgpt.com "Detect Behavior with Sensor Data - CMI"
[2]: https://www.st.com/en/imaging-and-photonics-solutions/vl53l5cx.html?utm_source=chatgpt.com "VL53L5CX - Time-of-Flight (ToF) 8x8 multizone ranging ..."
[3]: https://www.kaggle.com/code/ryenhails/imu-only-baseline-lgbm-using-worldacc?utm_source=chatgpt.com "[IMU-only baseline] LGBM using WorldAcc"
[4]: https://www.kaggle.com/code/tarundirector/sensor-pulse-viz-eda-for-bfrb-detection?utm_source=chatgpt.com "ğŸ“‰Sensor PulseğŸ§ | Viz & EDA for BFRB Detection"
[5]: https://www.kaggle.com/code/satoshissss/cmi-bfrb-imu-inference-v10-frequency-features/input?scriptVersionId=244926159&utm_source=chatgpt.com "CMI-BFRB IMU Inference v10 - Frequency Features"
[6]: https://www.kaggle.com/code/hideyukizushi/cmi25-imu-thm-tof-tf-bilstm-gru-attention-lb-75?utm_source=chatgpt.com "CMI25 | IMU+THM/TOF |TF BiLSTM+GRU+Attention|LB.75"
